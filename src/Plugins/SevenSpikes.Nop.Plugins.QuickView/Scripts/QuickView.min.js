/*
* Copyright 2016 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

!function(t,i){function a(){var i=t(".quickViewWindow").data("kendoWindow");void 0!=i&&""!==i.content()&&i.close()}function e(){var i=t(".quickViewWindow").data("kendoWindow"),a=t("<div class='k-loading-mask'><div class='k-loading-image'/><div class='k-loading-color'/></div>").width("700px").height("360px");i.content(a),i.center(),i.open()}function o(i){t(".quickViewWindow").data("kendoWindow").content(i)}function n(){var i=t(".quickViewAdjustPictureOnProductAttributeValueChange");i.length>0&&t(document).on("quickView.product_attributes_changed",function(a){if(a.changedData&&a.changedData.pictureDefaultSizeUrl){var e=a.changedData.pictureDefaultSizeUrl;"true"===i.attr("data-isCloudZoomAvailable")?(e=e.substring(1,e.length-9),t('.quickViewWindow .cloudzoom-gallery[href*="'+e+'"]').click()):t(".quickViewWindow .gallery .picture img").attr("src",e)}})}function c(){var i=t(".quickViewRentalInfo");if(i.length>0){var a=i.attr("data-datePickerFormat"),e="#"+i.attr("data-startDateControlId"),o="#"+i.attr("data-endDateControlId");t(e).datepicker({dateFormat:a}),t(o).datepicker({dateFormat:a})}}function r(i){var r=t(".quickViewData").attr("data-retrieveQuickViewUrl");if(void 0!=r){var d={productID:i};t.ajax({beforeSend:function(){e()},cache:!1,type:"POST",data:t.toJSON(d),contentType:"application/json; charset=utf-8",url:r}).done(function(a){o(a);var e={header:"ui-icon-circle-arrow-e",activeHeader:"ui-icon-circle-arrow-s"},r=t(".quickViewData").attr("data-accordionpanelsheightstyle");t("#accordion").accordion({collapsible:!0,icons:e,heightStyle:r});var d=t(".quickView").offset(),u=t(".quickView").height();t(window).height()<u?t(".quickView").css("top",t(document).scrollTop()+10):t(".quickView").css("top",d.top-u/4),n(),c(),t.event.trigger({type:"nopQuickViewDataShownEvent",productId:i})}).fail(function(){alert("Loading the page failed."),a()})}}function d(i,a){var e=t(".quickViewData").attr("data-quickViewButtonText"),o=t(".quickViewData").attr("data-quickViewButtonTitle");void 0==e&&(e="Quick View");var n=t(a);t(n).each(function(){t(this).find(v).length<=0&&t(this).prepend('<div class="'+k+'"><a title="'+o+'">'+e+"</a></div>")}),t(v).off("click.quickview").on("click.quickview",function(){var a=t(this).parents(i).first().attr("data-productid");void 0!==a&&r(a)}),t.event.trigger({type:"nopQuickViewButtonsAddedCompleteEvent"})}function u(){var i=t(".quickViewData").attr("data-isQuickViewPopupDraggable");return void 0!=i&&"True"===i}function l(){var i=t(".quickViewData").attr("data-enableQuickViewPopupOverlay");return void 0!=i&&"True"===i}function s(){var i=t("body");if(i.length>0){i.prepend('<div class="quickViewWindow"></div>');var a=u(),e=l(),o=t(".quickViewWindow").kendoWindow({minHeight:"330px",minWidth:"660px",draggable:a,resizable:!1,modal:e,actions:["Close"],animation:!1,visible:!1,close:function(){t(".quickViewWindow").html(t("").html())}}).data("kendoWindow");o.wrapper.addClass("quickView"),t(document).on("click",".k-overlay",function(){o.close()})}}function w(){var i=t(".quickViewData").attr("data-productselector");return void 0!=i?i:""}function p(i){var a=t(".quickViewData").attr("data-productselectorchild");return void 0!==a&&a!==i&&t(i+" "+a).length>0?i+" "+a:i}var k="quick-view-button",v="."+k;t(document).on("nopQuickViewDataShownEvent",function(){var i=".quickViewWindow #add-to-cart-button-"+t("#add-to-cart-details").attr("data-productid");t(i).hasClass("nopAjaxCartProductVariantAddToCartButton")||(t(i).prop("onclick",null).off("click"),t(i).on("click",function(){var i=t("#add-to-cart-details").attr("data-url"),a=t(".quickViewWindow #product-details-form").serialize();a=a.replace(new RegExp("quickView_product_attribute","g"),"product_attribute"),t.ajax({cache:!1,url:i,data:a,type:"post",success:AjaxCart.success_process,complete:AjaxCart.resetLoadWaiting,error:AjaxCart.ajaxFailure})}))}),t(document).ready(function(){if(!(i.isMobile()||!i.isMobile()&&i.getViewPort().width<=768)){var e=w();if(""!==e){var o=p(e);d(e,o),t(document).on("nopAjaxCartProductAddedToCartEvent nopAjaxCartProductAddedToWishlistEvent",function(){a()}),t(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent",function(){o=p(e),d(e,o)}),s()}}})}(jQuery,sevenSpikes);